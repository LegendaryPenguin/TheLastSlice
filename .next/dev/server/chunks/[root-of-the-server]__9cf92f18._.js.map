{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nisch/Desktop/pizza-raid/src/lib/supabaseServer.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport function supabaseServer() {\r\n  return createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\r\n    {\r\n      auth: { persistSession: false },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,gMAAY,gFAEjB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YAAE,gBAAgB;QAAM;IAChC;AAEJ"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nisch/Desktop/pizza-raid/src/app/api/raid/start/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { supabaseServer } from \"@/lib/supabaseServer\";\r\n\r\nexport async function POST(req: Request) {\r\n  const sb = supabaseServer();\r\n  const body = await req.json();\r\n\r\n  const code = String(body.code || \"\").toUpperCase().trim();\r\n\r\n  const { data: raid, error: raidErr } = await sb\r\n    .from(\"raids\")\r\n    .select(\"*\")\r\n    .eq(\"code\", code)\r\n    .single();\r\n\r\n  if (raidErr || !raid) return NextResponse.json({ error: \"Raid not found.\" }, { status: 404 });\r\n  if (raid.status !== \"lobby\") return NextResponse.json({ error: \"Raid not in lobby.\" }, { status: 409 });\r\n\r\n  const startedAt = new Date();\r\n  const endsAt = new Date(startedAt.getTime() + raid.duration_seconds * 1000);\r\n\r\n  const { data: updated, error } = await sb\r\n    .from(\"raids\")\r\n    .update({\r\n      status: \"live\",\r\n      started_at: startedAt.toISOString(),\r\n      ends_at: endsAt.toISOString(),\r\n    })\r\n    .eq(\"id\", raid.id)\r\n    .select(\"*\")\r\n    .single();\r\n\r\n  if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n\r\n  return NextResponse.json({ raid: updated });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,MAAM,KAAK,IAAA,gJAAc;IACzB,MAAM,OAAO,MAAM,IAAI,IAAI;IAE3B,MAAM,OAAO,OAAO,KAAK,IAAI,IAAI,IAAI,WAAW,GAAG,IAAI;IAEvD,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,OAAO,EAAE,GAAG,MAAM,GAC1C,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,QAAQ,MACX,MAAM;IAET,IAAI,WAAW,CAAC,MAAM,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAkB,GAAG;QAAE,QAAQ;IAAI;IAC3F,IAAI,KAAK,MAAM,KAAK,SAAS,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAqB,GAAG;QAAE,QAAQ;IAAI;IAErG,MAAM,YAAY,IAAI;IACtB,MAAM,SAAS,IAAI,KAAK,UAAU,OAAO,KAAK,KAAK,gBAAgB,GAAG;IAEtE,MAAM,EAAE,MAAM,OAAO,EAAE,KAAK,EAAE,GAAG,MAAM,GACpC,IAAI,CAAC,SACL,MAAM,CAAC;QACN,QAAQ;QACR,YAAY,UAAU,WAAW;QACjC,SAAS,OAAO,WAAW;IAC7B,GACC,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM,CAAC,KACP,MAAM;IAET,IAAI,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO,MAAM,OAAO;IAAC,GAAG;QAAE,QAAQ;IAAI;IAE5E,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,MAAM;IAAQ;AAC3C"}}]
}